{% comment %}
  Dromgoole's Footer Section
  A footer with brand info, menu, and newsletter blocks matching the original Dawn design.
  Uses Horizon patterns with custom Dromgoole's blocks.
{% endcomment %}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div
  class="section section--{{ section.settings.section_width }} color-{{ section.settings.color_scheme }}"
>
  {% liquid
    assign total_blocks = section.blocks.size

    # Grid layout calculations
    assign grid_columns = total_blocks | at_most: 4

    # Calculate last row counts using modulo arithmetic
    assign last_row_count = total_blocks | minus: 1 | modulo: 4 | plus: 1
    assign tablet_last_row_count = total_blocks | minus: 1 | modulo: 2 | plus: 1

    # Check if there are orphaned elements
    assign has_isolated_grid_item_desktop = false
    assign has_isolated_grid_item_tablet = false

    if total_blocks > 4 and last_row_count == 1
      assign has_isolated_grid_item_desktop = true
    endif

    if total_blocks == 5
      assign has_isolated_grid_item_tablet = true
    endif
  %}
  <div
    class="
      dromgooles-footer-content
      spacing-style
      {% if has_isolated_grid_item_desktop %}dromgooles-footer-content--isolated-grid-item-desktop{% endif %}
      {% if has_isolated_grid_item_tablet %}dromgooles-footer-content--isolated-grid-item-tablet{% endif %}
    "
    style="
      {%  render 'spacing-style', settings: section.settings %}
      --footer-gap: {{ section.settings.gap }}px;
      --grid-columns: {{ grid_columns }};
      --last-row-count: {{ last_row_count }};
      --tablet-last-row-count: {{ tablet_last_row_count }};
    "
  >
    {% content_for 'blocks' %}
  </div>
</div>

{% stylesheet %}
  .dromgooles-footer-content {
    contain: content;
    content-visibility: auto;
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--footer-gap);
  }

  @media screen and (min-width: 750px) and (max-width: 989px) {
    .dromgooles-footer-content {
      grid-template-columns: repeat(min(var(--grid-columns), 3), 1fr);
      grid-auto-flow: row;
    }

    .dromgooles-footer-content[style*='--grid-columns: 4'] {
      grid-template-columns: repeat(2, 1fr);
    }

    .dromgooles-footer-content--isolated-grid-item-tablet > :last-child {
      grid-column: 1 / -1;
    }
  }

  @media screen and (min-width: 990px) {
    .dromgooles-footer-content {
      grid-template-columns: repeat(var(--grid-columns), 1fr);
    }

    .dromgooles-footer-content[style*='--grid-columns: 1'] {
      justify-items: center;
    }

    .dromgooles-footer-content--isolated-grid-item-desktop > :last-child {
      grid-column: 1 / -1;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Footer (Dromgoole's)",
  "class": "section-wrapper dromgooles-footer-section",
  "tag": "footer",
  "blocks": [
    {
      "type": "@theme"
    },
    {
      "type": "@app"
    }
  ],
  "enabled_on": {
    "groups": ["footer"]
  },
  "settings": [
    {
      "type": "select",
      "id": "section_width",
      "label": "t:settings.width",
      "options": [
        {
          "value": "page-width",
          "label": "t:options.page"
        },
        {
          "value": "full-width",
          "label": "t:options.full"
        }
      ],
      "default": "page-width"
    },
    {
      "type": "range",
      "id": "gap",
      "label": "t:settings.gap",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-6"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "Footer (Dromgoole's)",
      "category": "t:categories.footer",
      "settings": {
        "gap": 30,
        "color_scheme": "scheme-6",
        "padding-block-start": 36,
        "padding-block-end": 36
      },
      "blocks": {
        "brand": {
          "type": "dromgooles-brand-info",
          "settings": {
            "tagline": "A family owned business that's been putting ink on paper since 1961!",
            "phone": "713.526.4651",
            "email": "cs.dromgooles@gmail.com",
            "address": "2515 Rice Blvd. Houston, TX 77005",
            "hours": "8:30-5:30 M-F | 9-5 Saturday\nClosed Sundays"
          }
        },
        "menu": {
          "type": "menu",
          "settings": {
            "menu": "footer"
          }
        },
        "newsletter": {
          "type": "dromgooles-newsletter",
          "settings": {
            "heading": "Newsletter",
            "text": "Stay up to date with new releases, promotions, events, and news with our newsletter and email updates."
          }
        }
      },
      "block_order": ["brand", "menu", "newsletter"]
    }
  ]
}
{% endschema %}
