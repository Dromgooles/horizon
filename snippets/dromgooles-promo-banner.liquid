{%- doc -%}
  Dromgoole's promotional banner block - a composable container with background styling.
  Add any theme blocks inside (text, buttons, images, etc.) for maximum flexibility.

  @param {string} [children] - Rendered child blocks via {% content_for 'blocks' %}
  @param {object} [settings] - Block settings
  @param {string} [shopify_attributes] - Block shopify attributes

  @example
  {% capture children %}{% content_for 'blocks' %}{% endcapture %}
  {% render 'dromgooles-promo-banner', children: children, settings: block.settings %}
{%- enddoc -%}

<div
  class="dromgooles-promo-banner size-style"
  style="
    {% render 'size-style', settings: settings %}
    --min-height: {{ settings.min_height | default: 400 }}px;
    --overlay-opacity: {{ settings.overlay_opacity | default: 30 | divided_by: 100.0 }};
    --content-direction: {{ settings.content_direction | default: 'column' }};
    --horizontal-alignment: {{ settings.horizontal_alignment | default: 'center' }};
    --vertical-alignment: {{ settings.vertical_alignment | default: 'center' }};
    --gap: {{ settings.gap | default: 16 }}px;
    --padding: {{ settings.padding | default: 32 }}px;
    --border-radius: {{ settings.border_radius | default: 0 }}px;
  "
  {{ shopify_attributes }}
>
  {% comment %} Background layer {% endcomment %}
  {% if settings.background_image %}
    <div class="dromgooles-promo-banner__background">
      {{
        settings.background_image
        | image_url: width: 1920
        | image_tag:
          loading: 'lazy',
          class: 'dromgooles-promo-banner__image',
          widths: '400, 600, 800, 1000, 1200, 1400, 1600, 1920',
          sizes: '100vw'
      }}
      <div class="dromgooles-promo-banner__overlay"></div>
    </div>
  {% elsif settings.background_gradient != blank %}
    <div
      class="dromgooles-promo-banner__background"
      style="background: {{ settings.background_gradient }};"
    ></div>
  {% elsif settings.background_color != blank %}
    <div class="dromgooles-promo-banner__background" style="background: {{ settings.background_color }};"></div>
  {% endif %}

  {% comment %} Content layer - renders child blocks {% endcomment %}
  <div class="dromgooles-promo-banner__content">
    {{ children }}
  </div>
</div>

{% stylesheet %}
  .dromgooles-promo-banner {
    position: relative;
    display: flex;
    align-items: var(--vertical-alignment, center);
    justify-content: var(--horizontal-alignment, center);
    min-height: var(--min-height, 400px);
    overflow: hidden;
    border-radius: var(--border-radius, 0);
  }

  .dromgooles-promo-banner__background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 0;
  }

  .dromgooles-promo-banner__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
  }

  .dromgooles-promo-banner__overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, var(--overlay-opacity, 0.3));
  }

  .dromgooles-promo-banner__content {
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: var(--content-direction, column);
    align-items: var(--horizontal-alignment, center);
    justify-content: var(--vertical-alignment, center);
    gap: var(--gap, 16px);
    padding: var(--padding, 32px);
    width: 100%;
    max-width: 1000px;
    color: rgba(var(--color-foreground), 1);
  }

  /* Ensure text is readable on background images */
  .dromgooles-promo-banner:has(.dromgooles-promo-banner__image) .dromgooles-promo-banner__content {
    color: white;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  }

  @media screen and (max-width: 749px) {
    .dromgooles-promo-banner {
      min-height: calc(var(--min-height, 400px) * 0.7);
    }

    .dromgooles-promo-banner__content {
      flex-direction: column;
      padding: calc(var(--padding, 32px) * 0.75);
    }
  }
{% endstylesheet %}
